<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audit local | BiblioNet</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<div th:replace="layout/header :: header"></div>
<div th:replace="layout/sidebar :: sidebar"></div>

<main class="content">

    <!-- ================= EN-T√äTE ================= -->
    <div class="page-header">
        <div>
            <h2>
                <i class="fas fa-clipboard-list"></i>
                Audit local ‚Äì Activit√©s de la biblioth√®que
            </h2>
            <p class="text-muted">
                Historique des actions r√©alis√©es par les biblioth√©caires
            </p>
        </div>
        
        <!-- Bouton d'export optionnel -->
        <!--
        <a th:href="@{/admin/audit/export/pdf}" class="btn btn-primary">
            <i class="fas fa-file-pdf"></i>
            Exporter PDF
        </a>
        -->
    </div>

    <!-- ================= STATISTIQUES RAPIDES (OPTIONNEL) ================= -->
    <!--
    <div class="audit-stats">
        <div class="audit-stat-card">
            <div class="audit-stat-icon">
                <i class="fas fa-tasks"></i>
            </div>
            <div class="audit-stat-info">
                <h4 th:text="${totalActions}">125</h4>
                <p>Actions totales</p>
            </div>
        </div>
        
        <div class="audit-stat-card">
            <div class="audit-stat-icon" style="background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);">
                <i class="fas fa-check-circle" style="color: #166534;"></i>
            </div>
            <div class="audit-stat-info">
                <h4 th:text="${successRate + '%'}">98%</h4>
                <p>Taux de succ√®s</p>
            </div>
        </div>
        
        <div class="audit-stat-card">
            <div class="audit-stat-icon" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);">
                <i class="fas fa-users" style="color: #92400e;"></i>
            </div>
            <div class="audit-stat-info">
                <h4 th:text="${activeUsers}">12</h4>
                <p>Utilisateurs actifs</p>
            </div>
        </div>
        
        <div class="audit-stat-card">
            <div class="audit-stat-icon" style="background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);">
                <i class="fas fa-clock" style="color: #3730a3;"></i>
            </div>
            <div class="audit-stat-info">
                <h4>Aujourd'hui</h4>
                <p>Derni√®re activit√©</p>
            </div>
        </div>
    </div>
    -->

    <!-- ================= FILTRES (OPTIONNEL) ================= -->
    <!--
    <div class="audit-filters">
        <input type="text" 
               placeholder="üîç Rechercher par acteur..." 
               id="searchActeur">
        
        <select id="filterAction">
            <option value="">Toutes les actions</option>
            <option value="AJOUT">AJOUT</option>
            <option value="MODIFICATION">MODIFICATION</option>
            <option value="SUPPRESSION">SUPPRESSION</option>
        </select>
        
        <select id="filterRole">
            <option value="">Tous les r√¥les</option>
            <option value="ADMIN">ADMIN</option>
            <option value="BIBLIOTHECAIRE">BIBLIOTHECAIRE</option>
        </select>
        
        <input type="date" id="filterDate">
        
        <button class="btn-primary">
            <i class="fas fa-filter"></i>
            Filtrer
        </button>
    </div>
    -->

    <!-- ================= TABLEAU PRINCIPAL ================= -->
    <div class="card">
        <table class="table">
            <thead>
                <tr>
                    <th>
                        <i class="fas fa-calendar-alt"></i>
                        Date
                    </th>
                    <th>
                        <i class="fas fa-user"></i>
                        Acteur
                    </th>
                    <th>
                        <i class="fas fa-shield-alt"></i>
                        R√¥le
                    </th>
                    <th>
                        <i class="fas fa-cog"></i>
                        Action
                    </th>
                    <th>
                        <i class="fas fa-bullseye"></i>
                        Cible
                    </th>
                    <th>
                        <i class="fas fa-info-circle"></i>
                        D√©tails
                    </th>
                    <th>
                        <i class="fas fa-check-circle"></i>
                        R√©sultat
                    </th>
                </tr>
            </thead>

            <tbody>
                <tr th:each="log : ${logs}">
                    
                    <!-- üìÖ Date -->
                    <td data-label="Date"
                        th:text="${#temporals.format(log.dateAction, 'dd/MM/yyyy HH:mm')}">
                        19/12/2024 14:30
                    </td>

                    <!-- üë§ Acteur -->
                    <td data-label="Acteur"
                        th:text="${log.acteur != null ? log.acteur.email : '‚Äî'}">
                        admin@bibliotheque.fr
                    </td>

                    <!-- üõ°Ô∏è R√¥le -->
                    <td data-label="R√¥le">
                        <span class="badge badge-blue"
                              th:text="${log.role}">
                            <i class="fas fa-user-shield"></i>
                            ADMIN
                        </span>
                    </td>

                    <!-- ‚öôÔ∏è Action -->
                    <td data-label="Action"
                        th:text="${log.action}">
                        AJOUT
                    </td>

                    <!-- üéØ Cible -->
                    <td data-label="Cible"
                        th:text="${log.cible}">
                        ISBN-123456789
                    </td>

                    <!-- üìù D√©tails -->
                    <td data-label="D√©tails"
                        th:text="${log.details != null ? log.details : '‚Äî'}"
                        th:title="${log.details}">
                        Le Petit Prince - Antoine de Saint-Exup√©ry
                    </td>

                    <!-- ‚úÖ / ‚ùå R√©sultat -->
                    <td data-label="R√©sultat">
                        <span th:if="${log.resultat == 'SUCCESS'}"
                              class="badge badge-green">
                            <i class="fas fa-check"></i>
                            Succ√®s
                        </span>
                        <span th:if="${log.resultat != 'SUCCESS'}"
                              class="badge badge-red">
                            <i class="fas fa-times"></i>
                            √âchec
                        </span>
                    </td>

                </tr>

                <!-- Cas aucun log -->
                <tr th:if="${#lists.isEmpty(logs)}">
                    <td colspan="7" style="text-align:center;">
                        <i class="fas fa-inbox" style="font-size: 3rem; color: #cbd5e1; margin-bottom: 16px; display: block;"></i>
                        <strong>Aucune activit√© enregistr√©e</strong>
                        <p style="color: #94a3b8; margin-top: 8px; font-size: 0.9rem;">
                            Les actions des biblioth√©caires appara√Ætront ici
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- ================= PAGINATION (OPTIONNEL) ================= -->
    <!--
    <div class="pagination">
        <a href="#" class="disabled">
            <i class="fas fa-chevron-left"></i>
            Pr√©c√©dent
        </a>
        
        <span>Page 1 sur 5</span>
        
        <a href="#">
            Suivant
            <i class="fas fa-chevron-right"></i>
        </a>
    </div>
    -->

</main>

<!-- ================= SCRIPT OPTIONNEL (FILTRES) ================= -->
<!--
<script>
    // Filtrage en temps r√©el
    document.getElementById('searchActeur')?.addEventListener('input', filterTable);
    document.getElementById('filterAction')?.addEventListener('change', filterTable);
    document.getElementById('filterRole')?.addEventListener('change', filterTable);
    document.getElementById('filterDate')?.addEventListener('change', filterTable);

    function filterTable() {
        const searchTerm = document.getElementById('searchActeur').value.toLowerCase();
        const actionFilter = document.getElementById('filterAction').value;
        const roleFilter = document.getElementById('filterRole').value;
        const dateFilter = document.getElementById('filterDate').value;
        
        const rows = document.querySelectorAll('.table tbody tr:not(:last-child)');
        
        rows.forEach(row => {
            const acteur = row.cells[1].textContent.toLowerCase();
            const action = row.cells[3].textContent;
            const role = row.cells[2].textContent;
            const date = row.cells[0].textContent;
            
            const matchSearch = acteur.includes(searchTerm);
            const matchAction = !actionFilter || action === actionFilter;
            const matchRole = !roleFilter || role.includes(roleFilter);
            const matchDate = !dateFilter || date.includes(dateFilter.split('-').reverse().join('/'));
            
            row.style.display = (matchSearch && matchAction && matchRole && matchDate) ? '' : 'none';
        });
    }
</script>
-->

</body>
</html>