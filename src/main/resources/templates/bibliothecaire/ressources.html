<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Ressources | BiblioNet</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
</head>

<body>

<!-- HEADER -->
<div th:replace="layout/header :: header"></div>

<!-- SIDEBAR -->
<div th:replace="layout/sidebar :: sidebar"></div>

<main class="content">

    <!-- TITRE + BOUTON -->
    <div class="page-header">
        <div>
            <h2>ðŸ“š Liste des ressources</h2>
            <p class="text-muted">Catalogue de votre bibliothÃ¨que</p>
        </div>

        <a class="btn btn-primary" th:href="@{/bibliothecaire/ressources/new}">
            âž• Ajouter une ressource
        </a>
    </div>

    <!-- LISTE -->
    <div class="resource-list">

        <!-- CARD -->
        <div class="resource-card" th:each="r : ${ressources}">

            <!-- IMAGE -->
            <div class="resource-img">
                <img th:if="${r.cheminCouverture != null}"
                     th:src="@{'/uploads/covers/' + ${r.cheminCouverture}}"
                     alt="Couverture">

                <div th:if="${r.cheminCouverture == null}" class="no-cover">
                    ðŸ“˜
                </div>
            </div>

            <!-- INFO -->
            <div class="resource-content">
<div th:if="${param.deleted}" class="alert alert-success">
    Ressource supprimÃ©e avec succÃ¨s âœ”
</div>

                <div class="resource-header">
                    <h3 th:text="${r.titre}"></h3>
                    <span class="badge badge-type" th:text="${r.typeRessource}"></span>
                </div>

                <p class="author" th:text="'Auteur : ' + ${r.auteur}"></p>

                <p>
                    <strong>CatÃ©gorie :</strong>
                    <span th:text="${r.categorie}"></span>
                </p>

                <p>
                    <strong>BibliothÃ¨que :</strong>
                    <span th:text="${r.bibliotheque.nom}"></span>
                </p>

                <!-- STOCK -->
   <div class="stock-box" th:with="s=${stocks[r.id]}">
    Disponible : <span th:text="${s.quantiteDisponible}"></span>
    Total : <span th:text="${s.quantiteTotale}"></span>
</div>


                <!-- ACTIONS (pour plus tard) -->
                <div class="resource-actions">
                   <a th:href="@{'/bibliothecaire/ressources/edit/' + ${r.id}}"
   class="btn btn-secondary">
   Modifier
</a>

<a th:href="@{'/bibliothecaire/ressources/delete/' + ${r.id}}"
   class="btn btn-danger"
   onclick="return confirm('Voulez-vous vraiment supprimer cette ressource ?');">
    ðŸ—‘ Supprimer
</a>
                </div>

            </div>

        </div>
    </div>

</main>

<div th:replace="layout/footer :: footer"></div>

</body>
</html>
